<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>sub window</title>
  </head>
  <body>
    <div class="container">
      <p>Sub Window</p>
      <p>
        <button id="window-openA">window.open [WindowA]</button>
      </p>
      <p>
        <button id="window-openB">window.open [WindowB]</button>
      </p>
      <p>Cookie: <span id="cookie"></p>
    </div>

    <script>


      function getCookie(key) {
        return document.cookie.replace(new RegExp("(?:(?:^|.*;\\s*)" + key + "\\s*\\=\\s*([^;]*).*$)|^.*$"), "$1");
      }

      function addCookie(key, value) {
        var values = getCookie(key);
        if (values === "") {
          values = [value];
        } else {
          var values = values.split(",");
          values.push(value);
        }
        document.cookie = key + "=" + values.join(",")
      }

      function removeCookie(key, value) {
        var cookie = getCookie(key).split(",");
        cookie = cookie.filter(function(val) { return val != value });
        document.cookie = key + "=" + cookie.join(",");
      }

      function isOpened(windowName) {
        return getCookie("sub_window").split(",").indexOf(windowName) >= 0;
      }

      function openSubWindow(target, name) {
        addCookie("sub_window", name);
        window.open(target, name);
      }


      document.querySelector("#window-openA").addEventListener("click", () => {
        if (!isOpened("windowA")) {
          openSubWindow("subsub.html", "windowA");
          console.log(document.cookie);
        }
      });

      document.querySelector("#window-openB").addEventListener("click", () => {
        if (!isOpened("windowB")) {
          openSubWindow("subsub.html", "windowB");
          console.log(document.cookie);
        }
      });

      document.querySelector("#cookie").textContent = document.cookie;

    </script>
  </body>
</html>
